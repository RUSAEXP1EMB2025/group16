#import "@preview/grape-suite:3.0.0": german-dates, seminar-paper
#set text(font: "Noto Serif JP", lang: "ja")

#v(1fr)
#align(center)[= Atmos 要求仕様書]

#v(1em)

#align(center)[== グループ16]

#v(0.5em)

#align(center, text()[
  #text[更新日] #datetime.today().display("[year]年[month]月[day]日")
])

#v(1fr)

#align(right)[
  #table(
    columns: auto,
    align: (left),
    stroke: none,
    [大村理駆],
    [安部魁起],
    [渡邊煌志],
    [伊藤智章],
  )
]

#pagebreak();

#outline();

#set text(size: 0.8em)

#pagebreak();

= 緒言

== システムの概要
Atmosは、ブラウザに表示されている内容によって、部屋の電気の明るさを変えることで雰囲気を調整するサービスである。
例えば、勉強系のページを表示していれば電気を明るく白くし、ホラー映画や小説を読んでいれば電気を暗くする。

== 適用範囲
本サービスは、Google ChromeブラウザおよびNature Remo 3の利用を前提とする。

== 用語定義

- 照度 (Illuminance): Nature Remo 3の照度センサーから取得される、部屋の現在の明るさを示す物理量。

- 雰囲気指数 (Atmosfreq): Webページの内容（テキスト、タグ、タイトル等）から解析・算出される、そのコンテンツが持つ雰囲気を数値化した指標。この指数と現在の部屋の照度を基に、目標とする照明状態を決定する。

= 全体記述

== 製品の背景と目的
Netflixなどで映画を鑑賞する際に部屋の明かりを消して楽しむユーザーや、勉強中に白色の照明を使用する学生が多く存在する。
これらのユーザーをターゲットに、ページ内容に応じて自動的に部屋の明るさを調整することで、利便性の向上と快適な環境の提供を目指すことが本サービスの目的である。

== 前提条件と依存関係
本サービスを利用する前に、ユーザーは以下の準備を完了していることを前提とする。
Nature Remo 3のセットアップが完了しており、Nature Remo APIを利用するためのアクセストークンが取得済みであること。
Google Chromeブラウザに本サービスの拡張機能がインストール済みであり、インターネットに接続されていること。

= 機能要件

== ブラウザ拡張機能
表示しているウェブサイトのカテゴリや内容に応じて、以下の処理を実行する。
+ 一般的なウェブサイトの場合:
  + 表示中のHTMLページから主要なテキストコンテンツを抽出し、Atmosサーバーから提供される辞書を用いてキーワード検索を行う。
  + 検索にヒットしたキーワード情報をAtmosサーバーに送信する。
  + 使用する辞書データは、AtmosサーバーのAPI経由で定期的に、または拡張機能起動時に取得する。
+ 動画配信サービス (例: Netflix, YouTubeなど) の場合:
  + 再生中の動画のタイトル、説明文、または付与されているジャンルタグ等のメタ情報を取得し、Atmosサーバーに送信する。
+ 検索エンジンサイト (例: Google検索など) の場合:
  + ユーザーが入力した検索クエリ（検索語句）に対し、Atmosサーバーから提供される辞書を用いてキーワード検索を行う。
  + 検索にヒットしたキーワード情報をAtmosサーバーに送信する。

== Atmosサーバー
+ ブラウザ拡張機能から送信された情報（キーワード、タイトル、タグ等）を解析し、雰囲気指数を算出する。
+ 算出された雰囲気指数と、Nature Remo 3から取得した現在の部屋の照度に基づき、目標とする照明状態（明るさ、場合によっては色温度）を決定する。
+ 決定した照明状態を、Nature Remo APIを介してNature Remo 3に指示として送信する。
+ ブラウザ拡張機能がキーワード検索に用いるための辞書データを、API経由で提供する。

== Nature Remo API連携機能
ユーザーが設定したアクセストークンを用いてNature Remo APIと安全に通信し、Nature Remo 3を操作する。
主な機能として、Nature Remo 3の照度センサーから現在の室内の照度を取得する機能、および接続されている照明デバイスの明るさや色温度を変更する機能を利用する。

= 非機能要件

== 性能要件
ユーザーがWebページを表示完了してから、照明状態が目標状態に反映されるまでの時間は、3秒以内とする。

== 可用性要件
Atmosサーバーは、原則として24時間365日稼働するものとする。

== セキュリティ要件
ブラウザ拡張機能がAtmosサーバーに送信する情報は、プライバシー保護の観点から必要最小限に留める。\
具体的には、ウェブページの全コンテンツを送信するのではなく、タイトル、キーワード、タグなどのメタデータや、
辞書検索によって抽出・フィルタリングされた関連性の高い情報のみを送信対象とする。

== ユーザビリティ要件
Nature Remo APIのアクセストークンは、ブラウザ拡張機能のポップアップUIから容易に設定・変更可能とする。
ユーザーが直感的に操作でき、設定内容を理解しやすいインターフェースを提供する。

== 保守性要件
Atmosサーバーは、適切なエラーハンドリングを実装し、問題発生時の原因究明を容易にするため、
トレーシングライブラリ等を活用した構造化されたログ（エラーログ、処理ログ等）を出力する。

== 信頼性要件
照明が頻繁に点滅したり、ユーザーの意図に反して急激に変化したりするなど、ユーザーに不快感を与える可能性のある動作を回避するよう、照明制御ロジックを設計する。
照明制御がループしたり、予期せぬ状態に陥ったりしないよう、状態管理を適切に行う。
